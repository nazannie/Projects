{"ast":null,"code":"import _slicedToArray from \"/Users/anian/Desktop/Project/services-all/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/anian/Desktop/Project/services-all/src/Message/Message.js\";\nimport React, { useRef, useState, useEffect, useContext } from \"react\";\nimport { fire } from \"../config/fire\";\nimport { UserContext } from \"../App\";\n\nfunction Messages(props) {\n  let user = useContext(UserContext);\n  let messagesRef = useRef(user.signedIn ? fire.firestore().collection(\"chats\").doc(fire.auth().currentUser.email) : null);\n\n  let _useState = useState(\"\"),\n      _useState2 = _slicedToArray(_useState, 2),\n      message = _useState2[0],\n      setMessage = _useState2[1];\n\n  let _useState3 = useState({}),\n      _useState4 = _slicedToArray(_useState3, 2),\n      list = _useState4[0],\n      setList = _useState4[1];\n\n  useEffect(() => {\n    messagesRef.current.onSnapshot(function (doc) {\n      setList(doc.data());\n    });\n  }, []);\n\n  function openChat(e) {\n    e.stopPropagation();\n    e.target.previousElementSibling.style.display = \"block\";\n  }\n\n  function closeChat(e) {\n    e.stopPropagation();\n    e.target.parentElement.style.display = \"none\";\n  }\n\n  function send(e) {\n    e.preventDefault();\n\n    if (list) {\n      messagesRef.current.update({\n        [Date.now()]: {\n          text: message,\n          sender: fire.auth().currentUser.email\n        }\n      }).then(() => setMessage(\"\"));\n    } else {\n      messagesRef.current.set({\n        [Date.now()]: {\n          text: message,\n          sender: fire.auth().currentUser.email\n        }\n      }).then(() => setMessage(\"\"));\n    }\n  }\n\n  return React.createElement(\"div\", {\n    className: \"chat-container\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"popup-container\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58\n    },\n    __self: this\n  }, React.createElement(\"button\", {\n    className: \"close-chat-btn\",\n    onClick: closeChat,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59\n    },\n    __self: this\n  }, \"X\"), React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    style: {\n      height: \"50vh\",\n      overflow: \"auto\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63\n    },\n    __self: this\n  }, list && Object.keys(list).map(date => {\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 67\n      },\n      __self: this\n    }, React.createElement(\"strong\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 68\n      },\n      __self: this\n    }, list[date].sender, \": \"), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 69\n      },\n      __self: this\n    }, list[date].text), React.createElement(\"span\", {\n      style: {\n        float: \"right\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 70\n      },\n      __self: this\n    }, new Date(+date).toDateString()));\n  })), React.createElement(\"form\", {\n    onSubmit: send,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77\n    },\n    __self: this\n  }, React.createElement(\"textarea\", {\n    value: message,\n    onChange: ({\n      target\n    }) => setMessage(target.value),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78\n    },\n    __self: this\n  }), React.createElement(\"button\", {\n    type: \"submit\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82\n    },\n    __self: this\n  }, \"Send\")))), React.createElement(\"button\", {\n    className: \"chat-button\",\n    onClick: openChat,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86\n    },\n    __self: this\n  }, \"open chat\"));\n}\n\nexport default Messages;","map":{"version":3,"sources":["/Users/anian/Desktop/Project/services-all/src/Message/Message.js"],"names":["React","useRef","useState","useEffect","useContext","fire","UserContext","Messages","props","user","messagesRef","signedIn","firestore","collection","doc","auth","currentUser","email","message","setMessage","list","setList","current","onSnapshot","data","openChat","e","stopPropagation","target","previousElementSibling","style","display","closeChat","parentElement","send","preventDefault","update","Date","now","text","sender","then","set","height","overflow","Object","keys","map","date","float","toDateString","value"],"mappings":"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","sourcesContent":["import React, { useRef, useState, useEffect, useContext } from \"react\";\nimport { fire } from \"../config/fire\";\nimport { UserContext } from \"../App\";\n\nfunction Messages(props) {\n  let user = useContext(UserContext);\n  let messagesRef = useRef(\n    user.signedIn\n      ? fire\n          .firestore()\n          .collection(\"chats\")\n          .doc(fire.auth().currentUser.email)\n      : null\n  );\n  let [message, setMessage] = useState(\"\");\n  let [list, setList] = useState({});\n\n  useEffect(() => {\n    messagesRef.current.onSnapshot(function(doc) {\n      setList(doc.data());\n    });\n  }, []);\n\n  function openChat(e) {\n    e.stopPropagation();\n    e.target.previousElementSibling.style.display = \"block\";\n  }\n\n  function closeChat(e) {\n    e.stopPropagation();\n    e.target.parentElement.style.display = \"none\";\n  }\n\n  function send(e) {\n    e.preventDefault();\n    if (list) {\n      messagesRef.current\n        .update({\n          [Date.now()]: {\n            text: message,\n            sender: fire.auth().currentUser.email\n          }\n        })\n        .then(() => setMessage(\"\"));\n    } else {\n      messagesRef.current\n        .set({\n          [Date.now()]: {\n            text: message,\n            sender: fire.auth().currentUser.email\n          }\n        })\n        .then(() => setMessage(\"\"));\n    }\n  }\n  return (\n    <div className=\"chat-container\">\n      <div className=\"popup-container\">\n        <button className=\"close-chat-btn\" onClick={closeChat}>\n          X\n        </button>\n        <div>\n          <div style={{ height: \"50vh\", overflow: \"auto\" }}>\n            {list &&\n              Object.keys(list).map(date => {\n                return (\n                  <div>\n                    <strong>{list[date].sender}: </strong>\n                    <p>{list[date].text}</p>\n                    <span style={{ float: \"right\" }}>\n                      {new Date(+date).toDateString()}\n                    </span>\n                  </div>\n                );\n              })}\n          </div>\n          <form onSubmit={send}>\n            <textarea\n              value={message}\n              onChange={({ target }) => setMessage(target.value)}\n            />\n            <button type=\"submit\">Send</button>\n          </form>\n        </div>\n      </div>\n      <button className=\"chat-button\" onClick={openChat}>\n        open chat\n      </button>\n    </div>\n  );\n}\n\nexport default Messages;\n"]},"metadata":{},"sourceType":"module"}