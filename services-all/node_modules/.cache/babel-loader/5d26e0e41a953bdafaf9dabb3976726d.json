{"ast":null,"code":"import _slicedToArray from \"/Users/anian/Documents/aca/services-all/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/anian/Documents/aca/services-all/src/Message/Message.js\";\nimport React, { useRef, useState, useEffect, useContext } from \"react\";\nimport { fire } from \"../config/fire\";\nimport { UserContext } from \"../App\";\nimport \"../styles/message.css\";\nimport AlertBox from \"../components/AlertBox\";\n\nfunction Messages(props) {\n  let user = useContext(UserContext);\n  let messagesRef = useRef(user.signedIn ? fire.firestore().collection(\"chats\").doc(fire.auth().currentUser.email) : null);\n\n  let _useState = useState(\"\"),\n      _useState2 = _slicedToArray(_useState, 2),\n      message = _useState2[0],\n      setMessage = _useState2[1];\n\n  let _useState3 = useState({}),\n      _useState4 = _slicedToArray(_useState3, 2),\n      list = _useState4[0],\n      setList = _useState4[1];\n\n  let _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      alert = _useState6[0],\n      setAlert = _useState6[1];\n\n  useEffect(() => {\n    if (alert) {\n      setTimeout(() => {\n        setAlert(false);\n      }, 3000);\n    }\n\n    messagesRef.current.onSnapshot(function (doc) {\n      setList(doc.data());\n    });\n  }, [alert]);\n\n  function openChat(e) {\n    e.stopPropagation();\n    e.target.previousElementSibling.style.display = \"block\";\n  }\n\n  function closeChat(e) {\n    e.stopPropagation();\n    e.target.parentElement.parentElement.style.display = \"none\";\n  }\n\n  function send(e) {\n    e.preventDefault();\n\n    if (message === \"\") {\n      setAlert(true);\n      return;\n    }\n\n    if (list) {\n      messagesRef.current.update({\n        [Date.now()]: {\n          text: message,\n          sender: fire.auth().currentUser.email\n        }\n      }).then(() => setMessage(\"\"));\n    } else {\n      messagesRef.current.set({\n        [Date.now()]: {\n          text: message,\n          sender: fire.auth().currentUser.email\n        }\n      }).then(() => setMessage(\"\"));\n    }\n  }\n\n  return React.createElement(\"div\", {\n    className: \"chat-container\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"popup-container\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"chat-header\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72\n    },\n    __self: this\n  }, React.createElement(\"p\", {\n    className: \"support-chat\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73\n    },\n    __self: this\n  }, \"Support Chat\"), React.createElement(\"button\", {\n    className: \"close-chat-btn\",\n    onClick: closeChat,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74\n    },\n    __self: this\n  }, \"X\")), React.createElement(\"div\", {\n    className: \"chat-content\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79\n    },\n    __self: this\n  }, alert ? React.createElement(AlertBox, {\n    message: \"Please enter a text to send\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80\n    },\n    __self: this\n  }) : null, list && Object.keys(list).map(date => {\n    return React.createElement(\"div\", {\n      className: \"chat-area\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84\n      },\n      __self: this\n    }, React.createElement(\"strong\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85\n      },\n      __self: this\n    }, list[date].sender, \": \"), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86\n      },\n      __self: this\n    }, list[date].text), React.createElement(\"span\", {\n      style: {\n        float: \"right\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87\n      },\n      __self: this\n    }, new Date(+date).toDateString()));\n  })), React.createElement(\"form\", {\n    className: \"chat-form\",\n    onSubmit: send,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94\n    },\n    __self: this\n  }, React.createElement(\"textarea\", {\n    className: \"msg-textarea\",\n    value: message,\n    onChange: ({\n      target\n    }) => setMessage(target.value),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95\n    },\n    __self: this\n  }), React.createElement(\"button\", {\n    className: \"msg-btn\",\n    type: \"submit\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100\n    },\n    __self: this\n  }, React.createElement(\"i\", {\n    className: \"fas fa-paper-plane\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101\n    },\n    __self: this\n  })))), React.createElement(\"button\", {\n    className: \"chat-button\",\n    onClick: openChat,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105\n    },\n    __self: this\n  }, \"Need help? Click here to get in touch with us\"));\n}\n\nexport default Messages;","map":{"version":3,"sources":["/Users/anian/Documents/aca/services-all/src/Message/Message.js"],"names":["React","useRef","useState","useEffect","useContext","fire","UserContext","AlertBox","Messages","props","user","messagesRef","signedIn","firestore","collection","doc","auth","currentUser","email","message","setMessage","list","setList","alert","setAlert","setTimeout","current","onSnapshot","data","openChat","e","stopPropagation","target","previousElementSibling","style","display","closeChat","parentElement","send","preventDefault","update","Date","now","text","sender","then","set","Object","keys","map","date","float","toDateString","value"],"mappings":"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","sourcesContent":["import React, { useRef, useState, useEffect, useContext } from \"react\";\nimport { fire } from \"../config/fire\";\nimport { UserContext } from \"../App\";\nimport \"../styles/message.css\";\nimport AlertBox from \"../components/AlertBox\";\n\nfunction Messages(props) {\n  let user = useContext(UserContext);\n  let messagesRef = useRef(\n    user.signedIn\n      ? fire\n          .firestore()\n          .collection(\"chats\")\n          .doc(fire.auth().currentUser.email)\n      : null\n  );\n  let [message, setMessage] = useState(\"\");\n  let [list, setList] = useState({});\n  let [alert, setAlert] = useState(false);\n\n  useEffect(() => {\n    if (alert) {\n      setTimeout(() => {\n        setAlert(false);\n      }, 3000);\n    }\n\n    messagesRef.current.onSnapshot(function(doc) {\n      setList(doc.data());\n    });\n  }, [alert]);\n\n  function openChat(e) {\n    e.stopPropagation();\n    e.target.previousElementSibling.style.display = \"block\";\n  }\n\n  function closeChat(e) {\n    e.stopPropagation();\n    e.target.parentElement.parentElement.style.display = \"none\";\n  }\n\n  function send(e) {\n    e.preventDefault();\n    if (message === \"\") {\n      setAlert(true);\n      return;\n    }\n    if (list) {\n      messagesRef.current\n        .update({\n          [Date.now()]: {\n            text: message,\n            sender: fire.auth().currentUser.email\n          }\n        })\n        .then(() => setMessage(\"\"));\n    } else {\n      messagesRef.current\n        .set({\n          [Date.now()]: {\n            text: message,\n            sender: fire.auth().currentUser.email\n          }\n        })\n        .then(() => setMessage(\"\"));\n    }\n  }\n  return (\n    <div className=\"chat-container\">\n      <div className=\"popup-container\">\n        <div className=\"chat-header\">\n          <p className=\"support-chat\">Support Chat</p>\n          <button className=\"close-chat-btn\" onClick={closeChat}>\n            X\n          </button>\n        </div>\n\n        <div className=\"chat-content\">\n          {alert ? <AlertBox message={\"Please enter a text to send\"} /> : null}\n          {list &&\n            Object.keys(list).map(date => {\n              return (\n                <div className=\"chat-area\">\n                  <strong>{list[date].sender}: </strong>\n                  <p>{list[date].text}</p>\n                  <span style={{ float: \"right\" }}>\n                    {new Date(+date).toDateString()}\n                  </span>\n                </div>\n              );\n            })}\n        </div>\n        <form className=\"chat-form\" onSubmit={send}>\n          <textarea\n            className=\"msg-textarea\"\n            value={message}\n            onChange={({ target }) => setMessage(target.value)}\n          />\n          <button className=\"msg-btn\" type=\"submit\">\n            <i className=\"fas fa-paper-plane\"></i>\n          </button>\n        </form>\n      </div>\n      <button className=\"chat-button\" onClick={openChat}>\n        Need help? Click here to get in touch with us\n      </button>\n    </div>\n  );\n}\n\nexport default Messages;\n"]},"metadata":{},"sourceType":"module"}